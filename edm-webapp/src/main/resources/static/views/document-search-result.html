<div class="k-content col-md-12">
	<form name="searchForm" class="navbar-form navbar-left" role="search">
		<div class="form-group" style="width:250px;">
			<input list="suggestions" ng-model="searchedPattern" type="text" class="form-control" placeholder="Que voulez-vous chercher ?" ng-required="true" ng-change="searchPatternHaveBeenUpdated()" />
			<datalist id="suggestions">
				Votre navigateur ne permets pas d'afficher les suggestions, essayer en un plus récent !
				<option ng-value="autocompleteDocument.name" label="{{autocompleteDocument.nodePath}}" ng-repeat="autocompleteDocument in autocompleteDocumentList" />
			</datalist>
		</div>
		<button ng-click="searchSubmit()"  class="btn btn-default" ng-disabled="searchForm.$invalid">Rechercher !</button>
	</form>
</div>

<br/><br/>
<hr/>

<div class="k-content col-md-12" ng-if="searchedPattern.trim().length !== 0">

	<button class="btn" type="button" data-toggle="collapse" data-target="#collapseFilter" aria-expanded="true" aria-controls="collapseFilter">
		Filtrer les résultats
	</button>

	<div class="collapse" id="collapseFilter">

		<hr/>

		<div class="k-content col-md-4">
			<strong>Extension des fichiers</strong>
			<br/>
			<canvas id="fileExtensionAggChart" class="chart chart-bar" data="fileExtensionAggData" labels="fileExtensionAggLabels" style="heigth:100px"></canvas> 
			<br/>
			<form name="input_fileExtension" class="filetype-columns">
				<span ng-repeat="aggItem in aggregations.fileExtension">
					<input	type="checkbox" 
							ng-checked="true" 
							ng-change="searchAggregationsHaveBeenUpdated()" 
							ng-model="fileExtension.aggValues[aggItem.key]" 
							ng-init="fileExtension.aggValues[aggItem.key] = true" 
					/>
					{{aggItem.key}} <span class="badge">{{aggItem.docCount}}</span>
					<br/>
				</span>
			</form>
		</div>
		
		<div class="k-content col-md-8">
			<strong>Date des fichiers</strong>
			<br/>
			<canvas id="dateAggChart" class="chart chart-line" data="dateAggData" labels="dateAggLabels" legend="true" series="dateAggSeries" click="onClickOnDateAggChart"></canvas> 
			<br/>
			<form name="input_fileDate" class="filedate-columns">
				<span ng-repeat="aggItem in aggregations.date">
					<input	type="checkbox" 
							ng-checked="true" 
							ng-change="searchAggregationsHaveBeenUpdated()" 
							ng-model="date.aggValues[aggItem.key]" 
							ng-init="date.aggValues[aggItem.key] = true" 
					/>
					{{aggItem.key | date:'MM/yyyy'}} <span class="badge">{{aggItem.docCount}}</span>
					<br/>
				</span>
			</form>
		</div>

	</div>
	
</div>


<div class="k-content col-md-8">

	<div class="pull-right" ng-show="searchResults"><small><em class="text-muted">{{searchResults.totalHitsCount}} documents trouvés en {{searchResults.tookTime}} ms</em></small></div>
	<br/>

	<div ng-repeat="searchResult in searchResults.searchResults">
	    <a class="lead" ng-href="{{linkToDocument(searchResult.edmDocument.nodePath)}}">
	    	<div ng-class="'icone-sprite ' + getDocumentNodeIcon(searchResult.edmDocument)"></div>
	        <span ng-bind-html="getTrustedHtmlContent(searchResult.highlightedName || searchResult.edmDocument.name)"></span>
	    </a>
	    <br/>
	    <span class="text-muted">
	        <a ng-href="{{linkToDocument(searchResult.edmDocument.nodePath)}}" class="text-muted" ng-bind-html="getTrustedHtmlContent(searchResult.highlightedNodePath || searchResult.edmDocument.nodePath)"></a>
	        <small>&mdash; {{searchResult.edmDocument.date | date : 'dd/MM/yyyy'}}</small>
	    </span>
	    <br/>
	    <p ng-bind-html="getTrustedHtmlContent(searchResult.highlightedDescription || searchResult.edmDocument.description)"></p>
	    <pre ng-show="searchResult.highlightedFileContentMatching" ng-bind-html="getTrustedHtmlContent(searchResult.highlightedFileContentMatching)">
	    </pre>
	    <hr/>
	</div>

</div>


<div class="k-content col-md-4">
	<strong>Le top des mots clés qui vous intéressent !</strong>
	<br/>
	<canvas id="topTermsChart" class="chart chart-radar" data="topTermsData" labels="topTermsLabels" click="updateSearchPatternFromChart"></canvas> 
</div>


